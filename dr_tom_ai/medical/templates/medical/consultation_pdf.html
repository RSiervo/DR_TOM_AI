{% load static %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Consultation {{ c.id }} — Dr. Tom AI</title>
  <style>
    @page { size: A4; margin: 20mm; }
    body { font-family: DejaVu Sans, Arial, Helvetica, sans-serif; color: #111; font-size: 12pt; }
    h1,h2 { margin: 0 0 8px 0; }
    h1 { font-size: 18pt; }
    h2 { font-size: 13pt; color: #0b60d1; }
    .muted { color: #666; font-size: 10pt; }
    .section { margin-bottom: 14px; }
    .box { border: 1px solid #ddd; border-radius: 8px; padding: 10px; }
    .small { font-size: 9pt; }
    .image { margin-top: 8px; }
    .footer { margin-top: 20px; border-top: 1px solid #eee; padding-top: 8px; }
    .disclaimer { font-size: 9pt; color: #555; }
  </style>
</head>
<body>
  <h1>Dr. Tom AI — Consultation #{{ c.id }}</h1>
  <div class="muted">Date: {{ c.created_at }}{% if c.user %} • User: {{ c.user.username }}{% endif %}</div>

  <div class="section">
    <h2>Symptoms</h2>
    <div class="box">
      {% if c.symptoms_text %}{{ c.symptoms_text|linebreaksbr }}{% else %}<span class="small muted">None provided</span>{% endif %}
    </div>
  </div>

  <div class="section">
    <h2>AI Result</h2>
    <div class="box">
      {% if c.result_text %}{{ c.result_text|linebreaksbr }}{% else %}<span class="small muted">No result available.</span>{% endif %}
    </div>
  </div>

  {% if c.image %}
  <div class="section">
    <h2>Image</h2>
    <!-- xhtml2pdf handles local file paths/URIs best. Use absolute path: -->
    <div class="image">
      <img src="{{ c.image.path }}" style="max-width: 100%; height: auto;">
    </div>
  </div>
  {% endif %}

  <div class="footer">
    <div class="disclaimer">
      This report is generated by Dr. Tom AI for educational purposes and is not a medical diagnosis.
      Seek professional care for urgent or serious symptoms.
    </div>
  </div>
</body>
</html>
